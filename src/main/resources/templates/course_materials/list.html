<div class="px-5" th:fragment="content" xmlns:th="http://www.w3.org/1999/xhtml">
  <style>
    @import url("/css/course-materials.css");
  </style>
  <div class="container-fluid mt-5 mb-5">
    <div class="d-flex">
      <div class="flex-grow-1">
        <div class="card shadow-lg border-0 rounded-3">
          <div
            class="card-header bg-dark text-white py-3 d-flex align-items-center"
          >
            <i class="bi bi-book me-2 fs-4"></i>
            <h1 class="fw-bold mb-0 fs-4">
              <span
                th:if="${currentCourse != null}"
                th:text="'Materials for ' + ${currentCourse.name}"
              ></span>
              <span th:unless="${currentCourse != null}">Course Materials</span>
            </h1>
          </div>
          <div class="card-body p-4">
            <div class="row align-items-center gy-3 mb-4">
              <div class="col-md-8">
                <form id="advancedSearchForm" class="mb-0">
                  <div class="row g-3 align-items-center">
                    <div class="col-md-3">
                      <div class="form-group position-relative">
                        <input
                          type="text"
                          class="form-control"
                          id="nameSearch"
                          name="name"
                          placeholder="Search by name..."
                          autocomplete="off"
                        />
                        <i
                          class="bi bi-search position-absolute top-50 end-0 translate-middle-y me-2 text-muted"
                        ></i>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <select
                        class="form-select"
                        id="sessionSearch"
                        name="sessionId"
                      >
                        <option value="">All Sessions</option>
                        <th:block
                          th:each="sessionOfCourse : ${sessionsOfCourse}"
                        >
                          <option
                            th:value="${sessionOfCourse.id}"
                            th:text="${sessionOfCourse.name}"
                          ></option>
                        </th:block>
                      </select>
                    </div>
                    <div class="col-md-2">
                      <select class="form-select" id="typeSearch" name="type">
                        <option value="">All Types</option>
                        <option value="PDF">PDF</option>
                        <option value="YOUTUBE">YouTube</option>
                        <option value="VIDEO">Video</option>
                        <option value="AUDIO">Audio</option>
                        <option value="TEXT">Text</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <input
                        type="number"
                        class="form-control"
                        id="timeSearch"
                        name="minTime"
                        placeholder="Min Time (min)"
                        min="0"
                      />
                    </div>
                    <div class="col-md-1 text-end">
                      <button
                        type="button"
                        class="btn btn-outline-secondary btn-sm"
                        onclick="window.location.reload()"
                        title="Clear Filters"
                      >
                        <i class="bi bi-arrow-clockwise"></i>
                      </button>
                    </div>
                  </div>
                  <div id="searchLoading" class="d-none mt-2">
                    <div
                      class="spinner-border spinner-border-sm text-primary"
                      role="status"
                    >
                      <span class="visually-hidden">Loading...</span>
                    </div>
                    <span class="ms-2 text-muted">Searching...</span>
                  </div>
                </form>
              </div>
              <div class="col-md-4 d-flex justify-content-end gap-2 flex-wrap">
                <button
                  type="button"
                  class="btn btn-outline-secondary btn-sm"
                  id="toggleViewBtn"
                  title="Toggle View"
                >
                  <i class="bi bi-table"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary btn-sm"
                  data-bs-toggle="modal"
                  data-bs-target="#positionModal"
                  title="Table of Contents"
                >
                  <i class="bi bi-list-ol"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary btn-sm"
                  data-bs-toggle="modal"
                  data-bs-target="#importModal"
                  title="Import"
                >
                  <i class="bi bi-upload"></i>
                </button>
                <a
                  th:href="@{/course-materials/export(search=${search})}"
                  class="btn btn-outline-secondary btn-sm"
                  title="Export"
                >
                  <i class="bi bi-file-earmark-excel"></i>
                </a>
                <a
                  th:href="@{/course-materials/print(search=${search})}"
                  class="btn btn-outline-secondary btn-sm"
                  title="Print"
                >
                  <i class="bi bi-printer"></i>
                </a>
                <a
                  th:href="@{/course-materials/new(courseId=${currentCourse.id})}"
                  class="btn btn-primary btn-sm"
                  title="Create New Material"
                >
                  <i class="bi bi-plus-circle"></i>
                </a>
              </div>
            </div>

            <!-- Rest of the existing HTML remains unchanged -->
            <div
              class="modal fade"
              id="importModal"
              tabindex="-1"
              aria-labelledby="importModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="importModalLabel">
                      Import Course Materials from Excel
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <p>
                      Download the Excel template before uploading your file:
                    </p>
                    <a
                      th:href="@{/course-materials/download-template}"
                      class="text-primary text-decoration-underline"
                    >
                      Download Course Material Template
                    </a>
                    <form
                      th:action="@{/course-materials/import}"
                      method="post"
                      enctype="multipart/form-data"
                      class="mt-3"
                    >
                      <div class="mb-3">
                        <label for="fileInput" class="form-label"
                          >Choose Excel File</label
                        >
                        <input
                          type="file"
                          name="file"
                          id="fileInput"
                          class="form-control"
                          accept=".xlsx,.xls"
                          required
                        />
                      </div>
                      <div class="d-flex justify-content-end">
                        <button
                          type="submit"
                          class="btn btn-outline-success btn-sm"
                        >
                          <i class="bi bi-upload"></i> Import
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="modal fade"
              id="positionModal"
              tabindex="-1"
              aria-labelledby="positionModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="positionModalLabel">
                      Table of Contents
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div
                    class="modal-body"
                    style="max-height: 70vh; overflow-y: auto"
                  >
                    <div class="table-of-contents">
                      <div th:each="entry : ${sessionMaterialMap}" class="mb-4">
                        <h5
                          class="session-title mb-3"
                          th:text="${entry.key.name}"
                        >
                          Session Name
                        </h5>
                        <div
                          class="ms-4 material-list"
                          th:data-session-id="${entry.key.id}"
                        >
                          <div
                            th:each="material, iterStat : ${entry.value}"
                            class="material-item mb-2 p-2 border rounded"
                            th:data-material-id="${material.id}"
                            th:data-material-name="${material.name}"
                            th:data-material-type="${material.type}"
                            style="cursor: move"
                          >
                            <div class="d-flex align-items-center">
                              <i
                                class="bi bi-grip-vertical me-2 text-muted"
                              ></i>
                              <span
                                class="material-number me-2"
                                th:text="${iterStat.count} + '.'"
                                >1.</span
                              >
                              <span
                                class="material-name"
                                th:text="${material.name}"
                                >Material Name</span
                              >
                              <span
                                class="badge rounded-pill material-type-badge"
                                th:data-type="${material.type}"
                                th:text="${material.type}"
                                >Type</span
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="modal-footer position-sticky bottom-0 bg-white border-top py-3"
                  >
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      id="savePositions"
                    >
                      Save Changes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <main>
              <div class="card border-0 shadow-sm">
                <!-- Main Table View -->
                <div
                  id="mainTableView"
                  class="view-content"
                  style="display: none"
                >
                  <div
                    class="table-responsive"
                    style="max-height: calc(100vh - 300px); overflow-y: auto"
                  >
                    <table class="table table-hover mb-0">
                      <thead class="bg-light">
                        <tr>
                          <th><input type="checkbox" id="selectAll" /></th>
                          <th scope="col" class="fw-semibold text-center">#</th>
                          <th scope="col" class="fw-semibold">Name</th>
                          <th scope="col" class="fw-semibold">Session</th>
                          <th scope="col" class="fw-semibold">Type</th>
                          <th scope="col" class="fw-semibold">Material</th>
                          <th scope="col" class="fw-semibold text-center">
                            Time (min)
                          </th>
                          <th scope="col" class="fw-semibold text-center">
                            Actions
                          </th>
                        </tr>
                      </thead>
                      <tbody id="materialTableBody">
                        <tr th:each="material, iterStat : ${materials}">
                          <td>
                            <input
                              type="checkbox"
                              class="selectItem"
                              th:value="${material.id}"
                            />
                          </td>
                          <td
                            th:text="${iterStat.count + (currentPage * size)}"
                            class="align-middle"
                          ></td>
                          <td
                            th:text="${material.name}"
                            class="align-middle fw-medium"
                            style="text-align: left"
                          ></td>
                          <td
                            th:text="${material.session != null ? material.session.name : 'N/A'}"
                            class="align-middle text-muted small"
                            style="text-align: left"
                          ></td>
                          <td>
                            <span
                              class="badge rounded-pill"
                              th:class="'badge rounded-pill ' +
                                                          (${material.type == 'PDF'} ? 'bg-soft-white' :
                                                          (${material.type == 'YOUTUBE'} ? 'bg-soft-blue' :
                                                          (${material.type == 'TEXT'} ? 'bg-soft-green' :
                                                          (${material.type == 'VIDEO'} ? 'bg-soft-purple' :
                                                          (${material.type == 'AUDIO'} ? 'bg-soft-orange' : 'bg-secondary')))))"
                              th:text="${material.type}"
                              >Type</span
                            >
                          </td>
                          <td>
                            <a
                              th:if="${material.fileUrl != null}"
                              th:href="@{${material.fileUrl}}"
                              target="_blank"
                              class="btn btn-sm btn-outline-secondary"
                              >View</a
                            >
                            <span
                              th:unless="${material.fileUrl != null}"
                              class="text-muted"
                              >No file</span
                            >
                          </td>
                          <td
                            th:text="${material.estimatedTimeInMinutes}"
                            class="align-middle text-center"
                          ></td>
                          <td class="text-center align-middle">
                            <div class="d-flex justify-content-center gap-2">
                              <a
                                th:href="@{/course-materials/edit/{id}(id=${material.id})}"
                                class="btn btn-sm btn-outline-secondary"
                                title="Edit"
                              >
                                <i class="fas fa-edit"></i>
                              </a>
                              <button
                                type="button"
                                class="btn btn-sm btn-outline-secondary"
                                data-bs-toggle="modal"
                                data-bs-target="#deleteModal"
                                th:data-id="${material.id}"
                                title="Delete"
                              >
                                <i class="fas fa-trash"></i>
                              </button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div
                    class="table-footer position-sticky bottom-0 bg-white border-top py-3 px-3"
                  >
                    <div
                      class="d-flex align-items-center justify-content-between"
                    >
                      <div class="d-flex align-items-center">
                        <button
                          id="deleteAll"
                          class="btn btn-danger me-3"
                          data-bs-toggle="modal"
                          data-bs-target="#deleteAllModal"
                        >
                          <i class="bi bi-trash"></i>
                          <span
                            >Delete Selected (<span id="selectedCount">0</span
                            >)</span
                          >
                        </button>
                        <span class="text-muted"
                          >Total Records:
                          <strong th:text="${totalItems}">0</strong></span
                        >
                      </div>
                      <nav aria-label="Material pagination">
                        <ul class="pagination justify-content-end mb-0">
                          <li
                            class="page-item"
                            th:classappend="${currentPage == 0} ? 'disabled'"
                          >
                            <a
                              class="page-link"
                              th:href="@{/course-materials(page=0, size=${size}, search=${search}, courseId=${currentCourse != null ? currentCourse.id : ''})}"
                              aria-label="First"
                            >
                              <i class="bi bi-chevron-double-left"></i>
                            </a>
                          </li>
                          <li
                            class="page-item"
                            th:classappend="${currentPage == 0} ? 'disabled'"
                          >
                            <a
                              class="page-link"
                              th:href="@{/course-materials(page=${currentPage - 1}, size=${size}, search=${search}, courseId=${currentCourse != null ? currentCourse.id : ''})}"
                              aria-label="Previous"
                            >
                              <i class="bi bi-chevron-left"></i>
                            </a>
                          </li>
                          <th:block
                            th:each="i : ${#numbers.sequence(currentPage - 1, currentPage + 1)}"
                            th:if="${i >= 0 and i < totalPages}"
                          >
                            <li
                              class="page-item"
                              th:classappend="${i == currentPage} ? 'active'"
                            >
                              <a
                                class="page-link"
                                th:href="@{/course-materials(page=${i}, size=${size}, search=${search}, courseId=${currentCourse != null ? currentCourse.id : ''})}"
                                th:text="${i + 1}"
                              ></a>
                            </li>
                          </th:block>
                          <li
                            class="page-item"
                            th:classappend="${currentPage == totalPages - 1} ? 'disabled'"
                          >
                            <a
                              class="page-link"
                              th:href="@{/course-materials(page=${currentPage + 1}, size=${size}, search=${search}, courseId=${currentCourse != null ? currentCourse.id : ''})}"
                              aria-label="Next"
                            >
                              <i class="bi bi-chevron-right"></i>
                            </a>
                          </li>
                          <li
                            class="page-item"
                            th:classappend="${currentPage == totalPages - 1} ? 'disabled'"
                          >
                            <a
                              class="page-link"
                              th:href="@{/course-materials(page=${totalPages - 1}, size=${size}, search=${search}, courseId=${currentCourse != null ? currentCourse.id : ''})}"
                              aria-label="Last"
                            >
                              <i class="bi bi-chevron-double-right"></i>
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </div>
                  </div>
                </div>

                <div
                  class="modal fade"
                  id="deleteModal"
                  tabindex="-1"
                  aria-labelledby="deleteModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title" id="deleteModalLabel">
                          Confirm
                        </h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        Are you sure you want to delete this material?
                      </div>
                      <div class="modal-footer">
                        <form
                          id="deleteForm"
                          th:action="@{/course-materials/delete/__ID__}"
                          method="get"
                        >
                          <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                          >
                            Cancel
                          </button>
                          <button type="submit" class="btn btn-danger">
                            Delete
                          </button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>

                <div
                  class="modal fade"
                  id="deleteAllModal"
                  tabindex="-1"
                  aria-labelledby="deleteAllModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title" id="deleteAllModalLabel">
                          Confirm Deletion
                        </h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        Are you sure you want to delete
                        <span id="deleteCount">0</span> selected material(s)?
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Cancel
                        </button>
                        <button
                          type="button"
                          id="confirmDeleteAll"
                          class="btn btn-danger"
                        >
                          Delete
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Test View -->
                <div id="testView" class="view-content">
                  <div class="row g-0">
                    <!-- Left side - Material Content -->
                    <div class="col-md-9">
                      <div
                        class="p-4"
                        style="max-height: 70vh; overflow-y: auto"
                      >
                        <!-- Default content when no material is selected -->
                        <div id="defaultContent" class="text-center py-5">
                          <i
                            class="bi bi-file-earmark-text fs-1 text-muted mb-3"
                          ></i>
                          <h5>Select a Material</h5>
                          <p class="text-muted">
                            Choose a material from the right side to view its
                            content.
                          </p>
                        </div>

                        <!-- PDF Viewer -->
                        <div id="pdfViewer" class="d-none">
                          <div
                            class="d-flex justify-content-between align-items-center mb-3"
                          >
                            <h4 id="pdfTitle" class="mb-0">PDF Document</h4>
                            <a
                              id="pdfDownloadLink"
                              href="#"
                              target="_blank"
                              class="btn btn-sm btn-outline-primary"
                            >
                              <i class="bi bi-download"></i> Download
                            </a>
                          </div>
                          <div class="ratio ratio-16x9">
                            <iframe
                              id="pdfFrame"
                              src=""
                              allowfullscreen
                            ></iframe>
                          </div>
                        </div>

                        <!-- Video Player -->
                        <div id="videoPlayer" class="d-none">
                          <div
                            class="d-flex justify-content-between align-items-center mb-3"
                          >
                            <h4 id="videoTitle" class="mb-0">Video Content</h4>
                            <a
                              id="videoLink"
                              href="#"
                              target="_blank"
                              class="btn btn-sm btn-outline-primary"
                            >
                              <i class="bi bi-box-arrow-up-right"></i> Open in
                              New Tab
                            </a>
                          </div>
                          <div class="ratio ratio-16x9">
                            <iframe
                              id="videoFrame"
                              src=""
                              allowfullscreen
                            ></iframe>
                          </div>
                        </div>

                        <!-- Local Video Player -->
                        <div id="localVideoPlayer" class="d-none">
                          <div
                            class="d-flex justify-content-between align-items-center mb-3"
                          >
                            <h4 id="localVideoTitle" class="mb-0">
                              Video Content
                            </h4>
                            <a
                              id="localVideoDownloadLink"
                              href="#"
                              target="_blank"
                              class="btn btn-sm btn-outline-primary"
                            >
                              <i class="bi bi-download"></i> Download
                            </a>
                          </div>
                          <div class="ratio ratio-16x9">
                            <video
                              id="localVideoElement"
                              controls
                              class="w-100"
                            >
                              <source src="" type="video/mp4" />
                              Your browser does not support the video element.
                            </video>
                          </div>
                        </div>

                        <!-- Audio Player -->
                        <div id="audioPlayer" class="d-none">
                          <div
                            class="d-flex justify-content-between align-items-center mb-3"
                          >
                            <h4 id="audioTitle" class="mb-0">Audio Content</h4>
                            <a
                              id="audioDownloadLink"
                              href="#"
                              target="_blank"
                              class="btn btn-sm btn-outline-primary"
                            >
                              <i class="bi bi-download"></i> Download
                            </a>
                          </div>
                          <div class="card">
                            <div class="card-body">
                              <audio id="audioElement" controls class="w-100">
                                <source src="" type="audio/mpeg" />
                                Your browser does not support the audio element.
                              </audio>
                            </div>
                          </div>
                        </div>

                        <!-- Text Editor -->
                        <div id="textEditor" class="d-none">
                          <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 id="textTitle" class="mb-0">Text Content</h4>
                            <div>
                              
                              <a id="textDownloadLink" href="#" target="_blank" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-download"></i> Download
                              </a>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-body">
                              <div id="textContent" class="text-content"></div>
                              <div id="textEditorContainer" class="d-none">
                                <textarea id="textEditorArea"></textarea>
                                <div class="mt-2">
                                  <button id="saveTextBtn" class="btn btn-primary btn-sm">Save</button>
                                  <button id="cancelTextBtn" class="btn btn-secondary btn-sm">Cancel</button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Right side - Session Contents -->
                    <div class="col-md-3">
                      <div
                        class="p-4"
                        style="max-height: 70vh; overflow-y: auto"
                      >
                        <div class="accordion" id="ssAccordion">
                          <div th:each="entry : ${sessionMaterialMap}">
                            <div class="accordion-item">
                              <h2 class="accordion-header">
                                <div class="d-flex align-items-center">
                                  <button
                                    class="accordion-button collapsed flex-grow-1"
                                    type="button"
                                    th:data-bs-toggle="collapse"
                                    th:data-bs-target="'#ss' + ${entry.key.id}"
                                  >
                                    <span th:text="${entry.key.name}"
                                      >Session Name</span
                                    >
                                  </button>
                                  <div class="dropdown">
                                    <button
                                      type="button"
                                      class="btn btn-sm btn-outline-primary me-2"
                                      data-bs-toggle="dropdown"
                                      aria-expanded="false"
                                      title="Add Material"
                                    >
                                      <i class="bi bi-plus"></i>
                                    </button>
                                    <ul
                                      class="dropdown-menu dropdown-menu-end material-options"
                                    >
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-youtube text-danger"
                                          ></i>
                                          <span>Add YouTube URL</span>
                                        </a>
                                      </li>
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-camera-video text-primary"
                                          ></i>
                                          <span>Add Video</span>
                                        </a>
                                      </li>
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-music-note-beamed text-success"
                                          ></i>
                                          <span>Add Audio</span>
                                        </a>
                                      </li>
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-file-pdf text-danger"
                                          ></i>
                                          <span>Add PDF</span>
                                        </a>
                                      </li>
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-file-text text-info"
                                          ></i>
                                          <span>Add Text</span>
                                        </a>
                                      </li>
                                      <li><hr class="dropdown-divider" /></li>
                                      <li>
                                        <a
                                          class="dropdown-item"
                                          href="javascript:void(0)"
                                        >
                                          <i
                                            class="bi bi-files text-secondary"
                                          ></i>
                                          <span>Add Multiple Types</span>
                                        </a>
                                      </li>
                                    </ul>
                                  </div>
                                </div>
                              </h2>
                              <div
                                th:id="'ss' + ${entry.key.id}"
                                class="accordion-collapse collapse"
                                data-bs-parent="#ssAccordion"
                              >
                                <div class="accordion-body p-0">
                                  <ul class="list-group list-group-flush">
                                    <li
                                      th:each="material : ${entry.value}"
                                      class="list-group-item d-flex justify-content-between align-items-center material-item"
                                      th:data-material-id="${material.id}"
                                      th:data-material-name="${material.name}"
                                      th:data-material-description="${material.description}"
                                      th:data-material-type="${material.type}"
                                      th:data-material-url="${material.fileUrl}"
                                      th:data-material-time="${material.estimatedTimeInMinutes}"
                                      style="
                                        cursor: pointer;
                                        padding-left: 40px;
                                      "
                                    >
                                      <div
                                        class="d-flex align-items-center flex-grow-1"
                                        onclick="handleMaterialClick(this)"
                                      >
                                        <span class="material-bullet me-2"
                                          >â€¢</span
                                        >
                                        <span
                                          th:text="${material.name}"
                                          class="me-2"
                                          >Material Name</span
                                        >
                                        <span
                                          class="badge rounded-pill material-type-badge"
                                          th:data-type="${material.type}"
                                          th:text="${material.type}"
                                          >Type</span
                                        >
                                      </div>
                                      <div class="d-flex gap-2">
                                        <button
                                          class="btn btn-outline-secondary btn-sm"
                                          onclick="handleMaterialEdit(event, this)"
                                          th:data-material-id="${material.id}"
                                          th:data-material-name="${material.name}"
                                          th:data-material-type="${material.type}"
                                          th:data-material-url="${material.fileUrl != null ? material.fileUrl : ''}"
                                          th:data-material-time="${material.estimatedTimeInMinutes != null ? material.estimatedTimeInMinutes : ''}"
                                          th:data-material-description="${material.description != null ? material.description : ''}"
                                        >
                                          <i class="fas fa-edit"></i>
                                        </button>
                                        <button
                                          class="btn btn-outline-danger btn-sm"
                                          onclick="handleMaterialDelete(event, this)"
                                          data-material-id="${material.id}"
                                        >
                                          <i class="fas fa-trash"></i>
                                        </button>
                                      </div>
                                    </li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </main>
          </div>
        </div>
      </div>
      <div
        class="ms-4 p-2 d-flex flex-column align-items-stretch gap-2"
        style="width: 200px; min-height: 250px; border: 1px dashed #ccc"
      >
        <!-- Edit Material Modal -->
        <div class="modal fade" id="editMaterialModal" tabindex="-1" aria-labelledby="editMaterialModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header bg-dark text-white">
                <h5 class="modal-title" id="editMaterialModalLabel">Edit Material</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form id="editMaterialForm">
                  <input type="hidden" id="editMaterialId" name="id">
                  <div class="mb-3">
                    <label for="editMaterialName" class="form-label">Material Name</label>
                    <input type="text" class="form-control" id="editMaterialName" name="name" required>
                  </div>
                  <div class="mb-3">
                    <label for="editMaterialType" class="form-label">Material Type</label>
                    <select class="form-select" id="editMaterialType" name="type" required>
                      <option value="">Select Type</option>
                      <option value="PDF">PDF</option>
                      <option value="YOUTUBE">YouTube</option>
                      <option value="VIDEO">Video</option>
                      <option value="AUDIO">Audio</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="editMaterialUrl" class="form-label">Material Link</label>
                    <input type="text" class="form-control" id="editMaterialUrl" name="fileUrl" readonly>
                  </div>
                  <div id="editTypeSpecificFields">
                    <!-- Dynamic fields will be inserted here -->
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="editMaterialForm" class="btn btn-primary">Save Changes</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Add Material Modal -->
        <div
          class="modal fade"
          id="addMaterialModal"
          tabindex="-1"
          aria-labelledby="addMaterialModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header bg-dark text-white">
                <h5 class="modal-title" id="addMaterialModalLabel">
                  Add Material
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <div
                  id="multipleMaterialsContainer"
                  style="max-height: 400px; overflow-y: auto"
                >
                  <div class="material-entry mb-3 p-3 border rounded">
                    <div
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <h6 class="mb-0">Material #1</h6>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-danger remove-material"
                        style="display: none"
                      >
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Material Name</label>
                      <input
                        type="text"
                        class="form-control material-name"
                        required
                      />
                    </div>
                    <div class="type-specific-fields">
                      <!-- Dynamic fields will be inserted here -->
                    </div>
                  </div>
                </div>
                <div class="d-flex justify-content-end">
                  <button
                    type="button"
                    class="btn btn-outline-primary btn-sm"
                    id="addAnotherMaterial"
                  >
                    <i class="bi bi-plus-circle"></i> Add Another Material
                  </button>
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button type="button" class="btn btn-primary" id="saveMaterial">
                  Save
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Add Multiple Types Modal -->
        <div
          class="modal fade"
          id="addMultipleTypesModal"
          tabindex="-1"
          aria-labelledby="addMultipleTypesModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header bg-dark text-white">
                <h5 class="modal-title" id="addMultipleTypesModalLabel">
                  Add Multiple Types
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <div
                  id="multipleTypesContainer"
                  style="max-height: 400px; overflow-y: auto"
                >
                  <div class="material-entry mb-3 p-3 border rounded">
                    <div
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <h6 class="mb-0">Material #1</h6>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-danger remove-material"
                        style="display: none"
                      >
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Material Name</label>
                      <input
                        type="text"
                        class="form-control material-name"
                        required
                      />
                    </div>
                    <div class="mb-3 type-select-container">
                      <label class="form-label">Material Type</label>
                      <select class="form-select material-type" required>
                        <option value="">Select Type</option>
                        <option value="PDF">PDF</option>
                        <option value="YOUTUBE">YouTube</option>
                        <option value="VIDEO">Video</option>
                        <option value="AUDIO">Audio</option>
                      </select>
                    </div>
                    <div class="type-specific-fields">
                      <!-- Dynamic fields will be inserted here -->
                    </div>
                  </div>
                </div>
                <button
                  type="button"
                  class="btn btn-outline-primary btn-sm mt-3"
                  id="addAnotherType"
                >
                  <i class="bi bi-plus-circle"></i> Add Another Material
                </button>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button
                  type="button"
                  class="btn btn-primary"
                  id="saveMultipleTypes"
                >
                  Save Changes
                </button>
              </div>
            </div>
          </div>
        </div>

        <button
          type="button"
          class="btn btn-primary btn-sm w-100"
          onclick="submitUpdateForm()"
        >
          <i class="bi bi-pencil-square me-1"></i> Update
        </button>

        <a href="/courses" class="btn btn-secondary btn-sm w-100">
          <i class="bi bi-arrow-left me-1"></i> Back to List
        </a>

        <a
          th:href="@{/courses/edit/{id}(id=${currentCourse.id})}"
          class="btn btn-outline-secondary btn-sm w-100"
          >Detail</a
        >

        <a
          th:href="@{/courses/edit/sessions(courseId=${currentCourse.id})}"
          class="btn btn-outline-secondary btn-sm w-100"
        >
          Session
        </a>

        <a
          th:href="@{/courses/edit/topic-tags(courseId=${currentCourse.id})}"
          class="btn btn-outline-secondary btn-sm w-100"
        >
          Topic-Tags
        </a>

        <a
          th:href="@{/course-materials(courseId=${currentCourse.id})}"
          class="btn btn-outline-secondary btn-sm w-100"
        >
          Assign Materials
        </a>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.ckeditor.com/ckeditor5/40.0.0/classic/ckeditor.js"></script>
 
<script th:src="@{/js/course-materials.js}"></script>

</div>
